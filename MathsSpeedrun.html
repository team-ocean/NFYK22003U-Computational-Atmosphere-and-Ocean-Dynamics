<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="favicon.png" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      },
      options: {
        renderActions: {
          addMenu: []
        }
      },
      svg: {
        fontCache: 'global',
        scale: 1.0
      }
    };
    document.addEventListener("DOMContentLoaded", () => {
    const sidebar = document.querySelector('.sidebar');
    const main = document.querySelector('.main-content');
    const wrapper = document.createElement('div');
    wrapper.className = 'layout';

    sidebar.parentNode.insertBefore(wrapper, sidebar);
    wrapper.appendChild(sidebar);
    wrapper.appendChild(main);
  });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" async></script>
</head>

<body>
  <div class="sidebar">
    <img src="Logo_NS-blackboard-Expand.png" alt="Sidebar Image">
    <nav>
      <ul class="nav-menu">
        <li><a href="index.html">Welcome to NFYK22003U</a></li>
           <ul class="sub-menu">
            <li><a href="CourseInformation.html">Course Information</a></li>
          </ul>
        <li><a href="Welcome.html">Scope and Sequence</a></li>
           <ul class="sub-menu">
            <li><a href="CoursePrerequisitesExam.html">Prerequisites Exam</a></li>
            <li><a href="IntroductiontoPythonProgramming.html">Introduction to Python Programming</a></li>
            <li><a href="MathsSpeedrun.html">Maths Speedrun</a></li>
          </ul>
        
        <li>
          <a href="Lecture1.html">Lecture 1 – Introduction and Transport Processes</a></li>
          <ul class="sub-menu">
            <li><a href="Project1.html">Project 1 – Oxygen Budget</a></li>
          </ul>
          <li><a href="Lecture2.html">Lecture 2 – The Dynamics of Rotating Planets</a></li>
          <ul class="sub-menu">
            <li><a href="Project2.html">Project 2 – The Sverdrup Relation</a></li>
          </ul>
          <li><a href="Lecture3.html">Lecture 3 – Origin of Carbon and Water on Earth</a></li>
          <li><a href="Lecture4.html">Lecture 4 – The Gulfstream</a></li>
          <ul class="sub-menu">
            <li><a href="Project3.html">Project 3 – Western Boundary Currents</a></li>
          </ul>
          <li><a href="Lecture5.html">Lecture 5 – Carbon and Plankton</a></li>
          <li><a href="Lecture6.html">Lecture 6 – Quasi-Geostrophy</a></li>
          <li><a href="Lecture7.html">Lecture 7 – Theory of the Ventilated Thermocline</a></li>
          <ul class="sub-menu">
            <li><a href="Project4.html">Project 4 – Shadow Zone</a></li>
          </ul>
          <li><a href="Lecture8.html">Lecture 8 – Waves</a></li>
          <li><a href="Lecture9.html">Lecture 9 – Atmospheric Thermodynamics</a></li>
          <ul class="sub-menu">
            <li><a href="Project5.html">Project 5 – Hadley Cell</a></li>
          </ul>
          <li><a href="Lecture10.html">Lecture 10 – Surface and Abyssal Circulation</a></li>
          <ul class="sub-menu">
            <li><a href="Project6.html">Project 6 – Overturning</a></li>
          </ul>
          <li><a href="Lecture11.html">Lecture 11 – Ocean Mixing and Overturning Circulation</a></li>
          <li><a href="Lecture12.html">Lecture 12 – Stability of the Atlantic Meridional Overturning Circulation</a></li>
          <ul class="sub-menu">
            <li><a href="Project7.html">Project 7 – Oscillations</a></li>
            <li><a href="TestExam.html">Test Exam</a></li>
          </ul>
          <li><a href="Lecture13.html">Lecture 13 – Applications of Machine Learning in CFD and GFD</a></li>
          <ul class="sub-menu">
            <li><a href="SailbyNightPhysics.html">Sail by Night Physics</a></li>
          </ul>
          <li><a href="Appendix.html">Appendix</a></li>

          <li><a href="References.html">References</a></li>
        </li>
      </ul>
    </nav>
  </div>

  <div class="main-content">
    <h1>Maths Speedrun</h1>


<h2>Differentiation</h2>
In physics, differentiation are used to describe phenomena, and the reason might be: the core of physics research is change, and differentiation is the mathematical tool used to describe change.<br>
In the following we assume that $C$ and $a$ are constants.
<ul>
  <li>$\frac{d}{dx}(C) = 0$;</li>
  <li>$\frac{d}{dx} x^n = nx^{n-1}$;</li>
  <li>$\frac{d}{dx} \sin x = \cos x$;</li>
  <li>$\frac{d}{dx} \cos x = -\sin x$;</li>
  <li>$\frac{d}{dx} \log_a x = \frac{\log_a e}{x}$; where $a > 0, a \neq 1$;</li>
  <li>$\frac{d}{dx} \ln x = \frac{1}{x}$;</li>
  <li>$\frac{d}{dx} a^x = a^x \ln a$;</li>
  <li>$\frac{d}{dx} e^x = e^x$.</li>
</ul>
<strong>Rules for Differentiation:</strong> Assume that $f$, $g$, and $h$ are differentiable functions.
We have the following rules of differentiation:
<ul>
  <li>$\frac{d}{dx} \{ f(x) + g(x) \} = \frac{d}{dx} f(x) + \frac{d}{dx} g(x) = f'(x) + g'(x)$
  (Addition Rule)</li>
  <li>$\frac{d}{dx} \{ f(x) - g(x) \} = \frac{d}{dx} f(x) - \frac{d}{dx} g(x) = f'(x) - g'(x)$
  (Subtraction Rule)</li>
  <li>$\frac{d}{dx} \{ C f(x) \} = C \frac{d}{dx} f(x) = C f'(x)$
  where $C$ is a constant</li>
  <li>$\frac{d}{dx} \{ f(x) g(x) \} = f(x) \frac{d}{dx} g(x) + g(x) \frac{d}{dx} f(x) = f(x) g'(x) + g(x) f'(x)$
  (Product Rule)</li>
  <li>$
\frac{d}{dx} \left\{ \frac{f(x)}{g(x)} \right\} = \frac{g(x) \frac{d}{dx} f(x) - f(x) \frac{d}{dx} g(x)}{[g(x)]^2}

= \frac{g(x) f'(x) - f(x) g'(x)}{[g(x)]^2}
$

if $g(x) \neq 0$ everywhere.</li>
</ul>

<strong>Derivatives of Inverse Functions:</strong> If $y = f(x)$, and $x = f^{-1}(y)$; then $dy/dx$ and $dx/dy$ are related by

  $$
  \frac{dy}{dx} = \frac{1}{\frac{dx}{dy}}
  $$

<strong>Derivatives of Parameterized Functions:</strong> If $x = f(t)$ and $y = g(t)$, and $y = y(x)$, then

  $$
  \frac{dy}{dx} = \frac{dy/dt}{dx/dt} = \frac{g'(t)}{f'(t)},
  $$

  provided that $f'(t) \neq 0$.<br>

<strong>[Ex]</strong> Product Rule

$$
\frac{d}{dx} \{ x \sin x \} = x \frac{d}{dx} \sin x + \sin x \frac{d}{dx} x
$$

$$
= x \cos x + \sin x
$$

<strong>[Ex]</strong> Quotient Rule
$$
\frac{d}{dx} \tan x = \frac{d}{dx} \left\{ \frac{\sin x}{\cos x} \right\}
$$

$$
= \frac{\cos x \frac{d}{dx} \sin x - \sin x \frac{d}{dx} \cos x}{(\cos x)^2}
$$

$$
= \frac{1}{(\cos x)^2}
$$

<strong>[Q]</strong>$
\frac{d}{dx} \arcsin x = \boxed{?}
$<br>
<strong>[Sol]</strong> (Let $y = \arcsin x$)

$$
\frac{d}{dx} \arcsin x = \frac{dy}{d \sin y} = \frac{1}{\frac{d \sin y}{dy}}
$$

$$
= \frac{1}{\cos y} = \frac{1}{\sqrt{1 - \sin^2 y}} = \frac{1}{\sqrt{1 - x^2}}
$$

<strong>[Q]</strong> Find
$
\frac{dy}{dx} = \boxed{?} \quad \text{where } y = \sin(t^2), \quad x = 1 + \sqrt{t}.
$<br>
<strong>[Sol]</strong>$$
\frac{dy}{dx} = \frac{(\sin(t^2))'}{(1 + \sqrt{t})'}
$$

$$
= \frac{2t \cos(t^2)}{\frac{1}{2\sqrt{t}}}
$$

$$
= 4t^{\frac{3}{2}} \cos(t^2)
$$

<strong>Derivatives of Commonly Used Functions:</strong> In the following we assume that u is a differentiable function of x. With the rules for differentiation and the derivatives of elementary functions mentioned before, we have the following derivatives of functions.
<ul>
<li>$
\frac{d}{dx} \tan u = \sec^2 u \cdot \frac{du}{dx}
$</li>
<li>$
\frac{d}{dx} \cot u = -\csc^2 u \cdot \frac{du}{dx}
$</li>
<li>$
\frac{d}{dx} \sec u = \sec u \tan u \cdot \frac{du}{dx}
$</li>
<li>$
\frac{d}{dx} \csc u = -\csc u \cot u \cdot \frac{du}{dx}
$</li>
<li>$
\frac{d}{dx} \arcsin u = \frac{1}{\sqrt{1 - u^2}} \cdot \frac{du}{dx}
$</li>
<li>$
\frac{d}{dx} \arccos u = -\frac{1}{\sqrt{1 - u^2}} \cdot \frac{du}{dx}
$</li>
<li>$
\frac{d}{dx} \arctan u = \frac{1}{1 + u^2} \cdot \frac{du}{dx}
$</li>
<li>$
\frac{d}{dx} \text{arccot}\, u = -\frac{1}{1 + u^2} \cdot \frac{du}{dx}
$</li>
<li>$
\frac{d}{dx} \, \text{arcsec} \, u = \pm \frac{1}{u \sqrt{u^2 - 1}} \, \frac{du}{dx}; \quad
\left\{
\begin{aligned}
&+ \text{ if } u > 1 \\
&- \text{ if } u < -1
\end{aligned}
\right.
$</li>
<li>$
\frac{d}{dx} \, \text{arccsc} \, u = \mp \frac{1}{u \sqrt{u^2 - 1}} \, \frac{du}{dx}; \quad
\left\{
\begin{aligned}
&- \text{ if } u > 1 \\
&+ \text{ if } u < -1
\end{aligned}
\right.
$</li>
</ul>
<table style="width: 100%; border-collapse: collapse; font-family: 'Courier New', Courier, monospace; background-color: #001a33; color: #aaccee; border: 1px solid #3c5c78;">
  <tbody>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">\( \frac{d}{dx} \sinh u = \cosh u \frac{du}{dx} \)</td>
      <td style="padding: 8px;">Hyperbolic</td>
    </tr>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">\( \frac{d}{dx} \cosh u = \sinh u \frac{du}{dx} \)</td>
      <td style="padding: 8px;"></td>
    </tr>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">\( \frac{d}{dx} \tanh u = \operatorname{sech}^2 u \frac{du}{dx} \)</td>
      <td style="padding: 8px;"></td>
    </tr>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">\( \frac{d}{dx} \coth u = -\operatorname{csch}^2 u \frac{du}{dx} \)</td>
      <td style="padding: 8px;"></td>
    </tr>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">\( \frac{d}{dx} \operatorname{sech} u = -\operatorname{sech} u \tanh u \frac{du}{dx} \)</td>
      <td style="padding: 8px;"></td>
    </tr>
    <tr style="border-bottom: 2px solid #3c5c78;">
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">\( \frac{d}{dx} \operatorname{csch} u = -\operatorname{csch} u \coth u \frac{du}{dx} \)</td>
      <td style="padding: 8px;"></td>
    </tr>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">\( \frac{d}{dx} \operatorname{arsinh} u = \frac{1}{\sqrt{1 + u^2}} \frac{du}{dx} \)</td>
      <td style="padding: 8px;">Inverse Hyperbolic</td>
    </tr>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">\( \frac{d}{dx} \operatorname{arcosh} u = \frac{1}{\sqrt{u^2 - 1}} \frac{du}{dx} \)</td>
      <td style="padding: 8px;"></td>
    </tr>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">\( \frac{d}{dx} \operatorname{artanh} u = \frac{1}{1 - u^2} \cdot \frac{du}{dx}; \quad |u| < 1 \)</td>
      <td style="padding: 8px;"></td>
    </tr>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">\( \frac{d}{dx} \operatorname{arcoth} u = \frac{1}{1 - u^2} \cdot \frac{du}{dx}; \quad |u| > 1 \)</td>
      <td style="padding: 8px;"></td>
    </tr>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">\( \frac{d}{dx} \operatorname{arsech} u = \frac{1}{u \sqrt{1 - u^2}} \frac{du}{dx} \)</td>
      <td style="padding: 8px;"></td>
    </tr>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">\( \frac{d}{dx} \operatorname{arcsch} u = -\frac{1}{u \sqrt{1 + u^2}} \frac{du}{dx} \)</td>
      <td style="padding: 8px;"></td>
    </tr>
  </tbody>
</table>




<h2>Chain Rule</h2>
<ul>
  <li>If $y = f(u)$ where $u = g(x)$, then

  $$
  \frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dx} = f'(u) \cdot \frac{du}{dx} = f'(g(x)) \cdot g'(x)
  $$</li>
  <li>Similarly, if $y = f(u)$ where $u = g(v)$ and $v = h(x)$, then
  $$
  \frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dv} \cdot \frac{dv}{dx}
  $$</li>
</ul>
<strong>[Ex]</strong>$$
u = f(x) = x^3,\quad y = g(u) = \sin u,
$$

$$
y = F(x) = g(f(x)) = \sin x^3.
$$

$$
\frac{dy}{dx} \equiv \frac{d}{dx} \sin x^3 = \cos x^3 \cdot 3x^2
$$

<strong>[Ex]</strong> $$
y = \sin z, \quad z = at, \quad x = e^t, \quad \text{then}
$$

$$
\frac{dy}{dx} = \frac{dy/dt}{dx/dt}
$$

$$
= \frac{1}{e^t} \cdot \left[ \frac{dy}{dz} \cdot \frac{dz}{dt} \right]
$$

$$
= \frac{1}{e^t} \cdot \cos z \cdot a = \frac{a \cos(at)}{e^t}
$$

Sometimes the function $y = y(x)$ can not be expressed as a function of $x$ explicitly. Instead, the relation between $y$ and $x$ is hidden in an equation. In such a case, we can not get the differentiation of $y$ directly. However, we could still use the chain rule to get $\frac{dy}{dx}$.<br>
<strong>[Implicit Differentiation]</strong> Consider the equation $R(x, y) = 0$. Assume that $y$ can be solved as a function of $x$, then the differentiation of $y$ with respect to $x$ can be found by applying $\frac{d}{dx}$ to both sides of $R(x, y) = 0$, obtaining

$$
\frac{dR(x, y)}{dx} + \frac{dR(x, y)}{dy} \cdot \frac{dy}{dx} = 0.
$$

From this equation one can solve for $\frac{dy}{dx}$, as a function of $x$ and $y$.<br>
This methods is known as <strong>implicit differentiation</strong>.<br>

<strong>[Q]</strong> Consider $R(x, y) = x^2 + 4xy^5 + 7xy + 8 = 0$. Find $\frac{dy}{dx} = \boxed{?}$<br>
<strong>[Sol]</strong> $$
\frac{dR(x, y)}{dx} + \frac{dR(x, y)}{dy} \cdot \frac{dy}{dx}
$$

$$
= 2x + 4(y^5 + 5xy^4 \cdot \frac{dy}{dx}) + 7(y + x \cdot \frac{dy}{dx})
$$

$$
= 0
$$
Then we have

$$
(20xy^4 + 7x) \frac{dy}{dx} = -(2x + 4y^5 + 7y)
$$

$$
\Rightarrow \frac{dy}{dx} = -\frac{2x + 4y^5 + 7y}{20xy^4 + 7x}
$$

<strong>[Q]</strong> Consider $R(x, y) = \sin y \cos x - 1 = 0$, find $\frac{dy}{dx} = ?$<br>
<strong>[Sol]</strong> $$
\frac{dR(x, y)}{dx} + \frac{dR(x, y)}{dy} \cdot \frac{dy}{dx}
= -\sin x \sin y + \cos x \cos y \cdot \frac{dy}{dx} = 0
$$
$$
\therefore \text{We have }
\boxed{\frac{dy}{dx} = \tan x \tan y}
$$



<h2>Integration</h2>
<strong>Informally Explanation of Definite Integrals:</strong>

Given a function $y = f(x)$ over the interval $[a, b]$, the definite integral
$$
\int_a^b f(x) \, dx
$$
is defined informally to be the signed area of the region in the $xy$-plane bounded by the graph of $f$, the $x$-axis, and the vertical lines $x = a$ and $x = b$, such that area above the $x$-axis adds to the total, and that below the $x$-axis subtracts from the total.
<ul>
  <li>$\int$ is the integral sign</li>
  <li>$f(x)$ is the integrand</li>
  <li>$[a, b]$ is the range of the integration</li>
  <li>$a(b)$ is the lower (upper) limit of the integration</li>
</ul>
<div style="display: flex; justify-content: space-between; gap: 20px; align-items: flex-start;">
  <div style="flex: 1; text-align: center;">
    <img src="Figures/MathsSpeedrun_IntergralSign.png" alt="IntergralSign" style="max-width: 100%; height: auto;">
    <div class="figure-caption">(The definite integral of a function is the signed area of the region bounded by its graph.)</div>
  </div>
  <div style="flex: 1; text-align: center;">
    <img src="Figures/MathsSpeedrun_RiemannSumIntergral.png" alt="RiemannSumIntergral" style="max-width: 100%; height: auto;">
    <div class="figure-caption">(A Riemann sum of a function \( f \) with respect to a tagged partition.)</div>
  </div>
</div>


$\forall \epsilon > 0, \exists \delta > 0$, such that for any tagged partition of $[a, b]$ with mesh $ m < \delta$, we have


$$
\left| \sum_{k=1}^{n} f(\zeta_k) \Delta x_k - S \right| < \epsilon.
$$

In such a case, we say that $f$ is <strong>Riemannian integrable</strong>
or integrable on $[a, b]$, and denote

$$
\int_a^b f(x)\, dx = S.
$$
In summary, one may simply write

$$
\boxed{
\int_a^b f(x)\, dx = \lim_{\lambda \to 0} \sum_{k=1}^{n} f(\zeta_k) \Delta x_k
}
$$

<h2>The Taylor Formula</h2>
<strong>Taylor Formula with Peano Remainder:</strong> Suppose that $f(x)$ is defined in a neighborhood
$(x_0 - \delta, x_0 + \delta) \text{ of } x_0, \text{ and for some } n \in \mathbb{N},$
$f \in D^{(n-1)}(x_0 - \delta, x_0 + \delta), \text{ and } f^{(n)}(x_0) \text{ exists. Then we have}$

$$
\begin{aligned}
f(x) &= f(x_0) + f'(x_0)(x - x_0) + \frac{1}{2} f''(x_0)(x - x_0)^2 \\
&\quad + \cdots + \frac{1}{n!} f^{(n)}(x_0)(x - x_0)^n + r_n(x),
\end{aligned}
$$

where the remainder $r_n(x) \in o((x - x_0)^n)$, as $x \to x_0$.<br>

The polynomial

$$
p_n(x) = f(x_0) + f'(x_0)(x - x_0) + \frac{1}{2} f''(x_0)(x - x_0)^2 + \cdots + \frac{1}{n!} f^{(n)}(x_0)(x - x_0)^n
$$

is called the Taylor polynomial of degree $n$. It can be seen as an approximation of the original function $f$ near $x_0$.<br>
<strong>Taylor Formula with Lagrange Remainder:</strong>
Let $f(x)$ be a function defined on $(a, b)$.
If $f \in D^{n+1}(a, b)$, then for any $x$ and $x_0 \in (a, b)$, we have

$$
\begin{aligned}
f(x) &= f(x_0) + f'(x_0)(x - x_0) + \frac{1}{2} f''(x_0)(x - x_0)^2 \\
&\quad + \cdots + \frac{1}{n!} f^{(n)}(x_0)(x - x_0)^n + r_n(x),
\end{aligned}
$$

where the remainder

$
r_n(x) = \frac{f^{(n+1)}(\zeta)}{(n+1)!} (x - x_0)^{n+1},
$

and $\zeta$ is some number between $x$ and $x_0$ (i.e., $\zeta \in (x, x_0)$ or $(x_0, x)$).<br>
<br>
<table style="width: 100%; border-collapse: collapse; font-family: 'Courier New', Courier, monospace; background-color: #001a33; color: #aaccee; border: 2px solid #3c5c78;">
    <thead>
    <tr>
      <th style="padding: 12px; border-bottom: 2px solid #3c5c78;">
        Common Six Taylor Expansions
      </th>
    </tr>
  </thead>
  <tbody>
      <tr>
      <td style="padding: 10px; font-size: 1.2em;">
        \( e^x = 1 + x + \frac{x^2}{2!} + \cdots + \frac{x^n}{n!} + \mathcal{O}(x^n) \)
      </td>
    </tr>
    <tr>
      <td style="padding: 10px; font-size: 1.2em;">
        \( \sin x = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \cdots + (-1)^n \frac{x^{2n+1}}{(2n+1)!} + \mathcal{O}(x^{2n+1}) \)
      </td>
    </tr>
    <tr>
      <td style="padding: 10px; font-size: 1.2em;">
        \( \cos x = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \cdots + (-1)^n \frac{x^{2n}}{(2n)!} + \mathcal{O}(x^{2n}) \)
      </td>
    </tr>
    <tr>
      <td style="padding: 10px; font-size: 1.2em;">
        \( \ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3} - \cdots + (-1)^n \frac{x^{n+1}}{n+1} + \mathcal{O}(x^{n+1}) \)
      </td>
    </tr>
    <tr>
      <td style="padding: 10px; font-size: 1.2em;">
        \( \frac{1}{1-x} = 1 + x + x^2 + \cdots + x^n + \mathcal{O}(x^n) \)
      </td>
    </tr>
    <tr style="border-bottom: 2px solid #3c5c78;">
      <td style="padding: 10px; font-size: 1.2em;">
        \( (1+x)^m = 1 + mx + \frac{m(m-1)}{2!}x^2 + \cdots + \frac{m(m-1)\cdots(m-n+1)}{n!}x^n + \mathcal{O}(x^n) \)
      </td>
    </tr>
  </tbody>
</table>



<br>

<strong>[Q]</strong> Consider $f(x) = e^x$. Find its Taylor formula near $x_0 = 0$.<br>
<strong>[Sol]</strong> We have

$$
f(x) = f'(x) = f''(x) = \cdots = f^{(n)}(x) = e^x,
$$

and

$$
f(0) = f'(0) = f''(0) = \cdots = f^{(n)}(0) = 1.
$$

$$
\Rightarrow e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots + \frac{x^n}{n!} + r_n(x),
$$

where

$
r_n(x) = o(x^n),$ or $r_n(x) = \frac{e^{\eta x}}{(n+1)!} x^{n+1}, $ for some $ \eta \in (0,1)$.<br>

<strong>[Q]</strong> Consider $f(x) = \sin(x)$. Find its Taylor formula near $x_0 = 0$. <br>
<strong>[Sol]</strong>

$$
\because f^{(k)}(x) = \sin\left(x + \frac{k}{2} \pi\right).
$$


$$
\therefore \sin(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!} + \cdots + (-1)^n \frac{x^{2n+1}}{(2n+1)!} + r_{2n+2}(x),
$$

where

$r_{2n+2}(x) = o(x^{2n+2})$, or $r_{2n+2}(x) = \frac{x^{2n+3}}{(2n+3)!} \sin\left(\eta x + \frac{2n+3}{2} \pi\right)$, for some $\eta \in (0, 1)$.<br>

<strong>[Q]</strong> Find $\lim_{x \to 0} \frac{\cos(x) - e^{-\frac{x^2}{2}}}{x^4} = \boxed{?}$<br>
<strong>[Sol]</strong> 
\begin{align*}
\lim_{x \to 0} \frac{\cos(x) - e^{-\frac{x^2}{2}}}{x^4}
&= \lim_{x \to 0} \frac{\left[1 - \frac{x^2}{2!} + \frac{x^4}{4!} + o(x^4)\right] - \left[1 + \left(-\frac{x^2}{2}\right) + \frac{1}{2!} \left(-\frac{x^2}{2}\right)^2 + o(x^4)\right]}{x^4} \\
&= \lim_{x \to 0} \frac{-\frac{1}{12}x^4 + o(x^4)}{x^4} \\
&= -\frac{1}{12}
\end{align*}


The Note 1.1 Mathematical Approximation Methods in <i>An Introduction to Mechanics</i> by Daniel Kleppner and Robert Kolenkow is an excellent text for demonstrating how to apply mathematical approximations in physics.

<h2>Areas and Volumes</h2>
Let $f$ and $g$ be continuous functions whose graphs intersect at the graphical points corresponding to $x = a$ and $x = b$, $a < b$. If $g(x) \leq f(x)$ on $[a, b]$, then the area bounded by $f(x)$ and $g(x)$ is

$$
A = \int_a^b [f(x) - g(x)] \, dx
$$

<strong>Disk method:</strong> Disk method, is a means of calculating the volume of a solid of revolution of a solid-state material when integrating along the axis of revolution. This method models the resulting three-dimensional shape as a “stack” of an infinite number of disks of varying radius and infinitesimal thickness.
<img src="Figures/MathsSpeedrun_DiskMethod.png" alt="DiskMethod" style="margin-top: 1.5em; border-radius: 6px; max-width: 100%; display: block;">       
<div class="figure-caption">(Disc integration about the y-axis.)</div>

Assume that $x = f(y) \in C[c, d]$ and $f(y) \geq 0$. Then the volume of the solid of revolution obtained by revolving the region between the graph of $f(y)$ on $[c, d]$ about the y-axis is

$$
V = \pi \int_c^d [f(y)]^2 \, dy
$$

Assume that $y = f(x) \in C[a, b]$ and $f(x) \geq 0$. Then the volume of the solid of revolution obtained by revolving the region between the graph of $f(x)$ on $[a, b]$ about the x-axis is

$$
V = \pi \int_a^b [f(x)]^2 \, dx
$$

<strong>[Ex]</strong> A solid cone is generated by revolving the graph of $y = kx$,
$k > 0$ and $0 \leq x \leq b$, about the x-axis. Its volume is

$$
\begin{aligned}
V &= \pi \int_0^b k^2 x^2 \, dx \\
  &= \pi \frac{k^2 b^3}{3}
\end{aligned}
$$

<strong>Shell method:</strong>Shell method is a means of calculating the volume of a solid of revolution, when integrating along an axis perpendicular to the axis of revolution.
<img src="Figures/MathsSpeedrun_ShellMethod.png" alt="ShellMethod" style="margin-top: 1.5em; border-radius: 6px; max-width: 100%; display: block;">       
<div class="figure-caption">(Shell integration about the y-axis.)</div>
Suppose that $f \in C[a, b]$, $a \geq 0$, and $f(x) \geq 0$. Let $R$ be the plane region bound by $f(x)$, $x = a$, $x = b$, and the x-axis. The volume obtained by rotating $R$ around the y-axis is

$$
V = \int_a^b 2\pi x f(x) \, dx
$$

<strong>[Ex]</strong> If the region bounded by $y = kx$, $0 \leq x \leq b$ and $x = b$ rotates about the y-axis, then the volume of revolution obtained is

$$
\begin{aligned}
V &= 2\pi \int_0^b x(kx) \, dx \\
  &= 2\pi k \frac{b^3}{3}
\end{aligned}
$$

<img src="Figures/MathsSpeedrun_SketchDiskShell.png" alt="SketchDiskShell" style="margin-top: 1.5em; border-radius: 6px; max-width: 100%; display: block;">       



<h2>Ordinary Differential Equation</h2>
Ordinary Differential Equations (ODEs) has two parts:<ul>
  <li>Initial Value Problem
       $$
   \frac{d\vec{x}}{dt} = \vec{f}(t, \vec{x})
   $$

   $$
   \vec{x}(t_0) = \vec{x}_0
   $$
   \(\longleftrightarrow\) Important examples in <span class="doubleUnderline">Dynamical Systems</span>
  </li>

  <li>Boundary Value Problem</li>
</ul>

$$
\begin{array}{rl}
\left.
\begin{array}{l}
\text{ODE} \\
\text{PDE}
\end{array}
\right\} \text{DE}
& 
\begin{array}{l}
\text{Study some important (specific) problems} \\
\text{arising from physics,} \\
\text{biology, engineering, ...,} \\
\text{chemistry.}
\end{array}
\end{array}
$$

Periodic linear system:$$
\frac{d\mathbf{x}}{dt} = A(t)\mathbf{x}
$$

$$
A(t + \omega) = A(t)
$$

$$
\text{is periodic}
$$
Nonlinear Systems:$$
\left\{
\begin{aligned}
\frac{d\vec{x}}{dt} &= \vec{f}(\vec{x}) \\
\vec{x}(t_0) &= \vec{x}_0
\end{aligned}
\right.
$$

Goal: Given a system of
Nonlinear equations, we want to <span class="doubleUnderline">predict</span>
the behavior of solutions<br>
Analytic \(\longleftrightarrow\) Numerical Computational Method<br>

Review of Baby ODE:
1st order <span class="doubleUnderline">scalar</span> differential equation<br>

I.V.P. (Initial Value Problem)

$$
\left\{
\begin{aligned}
\frac{dx}{dt} &= f(t, x) \\
x(t_0) &= x_0
\end{aligned}
\right.
\quad \text{where } f : \mathbb{R} \times \mathbb{R} \to \mathbb{R}
$$

Separable equations (seperation of variables):

$$
\frac{dx}{dt} = g(x) h(t)
$$

$$
\int \frac{dx}{g(x)} = \int h(t)\,dt + C
$$

$$
\boxed{G(x) = H(t) + C}
$$

Express $x$ as a function of $t$

$$
x = x(t), \quad t = \text{time}
$$
<strong>[Ex]</strong>$$
\left\{
\begin{aligned}
\frac{dx}{dt} &= ax \\
x(0) &= x_0
\end{aligned}
\right.
\quad a > 0
$$

$$
x(t) = \text{population of a species at time } t
$$

$$
\frac{dx}{dt} = \text{rate of change is proportional to the current population.}
$$

$$
\frac{1}{x} \frac{dx}{dt} = a \Rightarrow \frac{dx}{x} = a\,dt
$$
$$
\int \frac{dx}{x} = \int a \, dt
$$

Integrating both sides:

$$
\ln |x| = at + C
$$

Exponentiating both sides:

$$
x = e^{at + C} = e^C \cdot e^{at}
$$

Let $x_0 = e^C$, which is the initial value:

$$
x(0) = x_0
$$

$$
\therefore \boxed{x(t) = x_0 e^{at}}
$$

<strong>[Q]</strong> Write

$$
\begin{aligned}
    y'' + 3\sin(zy) + z' &= \cos t \\
    z''' + z'' + 3y' + z'y &= t
\end{aligned}
$$

as an equivalent first order system of differential equations.<br>

<strong>[Sol]</strong> To write this as a first-order system, define new variables:

$$
\begin{aligned}
x_1 &= y \\
x_2 &= y' \\
x_3 &= z \\
x_4 &= z' \\
x_5 &= z''
\end{aligned}
$$

Now express the system as:

$$
\begin{aligned}
x_1' &= x_2 \\
x_2' &= \cos t - 3\sin(x_3 x_1) - x_4 \\
x_3' &= x_4 \\
x_4' &= x_5 \\
x_5' &= t - x_5 - 3x_2 - x_4 x_1
\end{aligned}
$$

This is the equivalent first-order system of differential equations. <br>

<strong>[Q]</strong> Show that the solutions $x_1(t), x_2(t)$ of the Lotka–Volterra two species competition model

$$
\begin{aligned}
\frac{dx_1}{dt} &= r_1 x_1 \left(1 - \frac{x_1}{K_1} \right) - \alpha_1 x_1 x_2 \\
\frac{dx_2}{dt} &= r_2 x_2 \left(1 - \frac{x_2}{K_2} \right) - \alpha_2 x_1 x_2 \\
x_1(0) &> 0,\quad x_2(0) > 0
\end{aligned}
$$

are positive and bounded for all $t \geq 0$.


<h2>Euler Equations</h2>
Differential Equation
$$
x^n y^{(n)} + p_1 x^{n-1} y^{(n-1)} + \cdots + p_{n-1} x y' + p_n y = f(x)
$$
where $p_1, p_2, \dots, p_n$ are constants. This is called an Euler equation, and its solution method is <br>
Let $x = e^t$, i.e., $t = \ln x$, then:

$$
\frac{dy}{dx} = \frac{dy}{dt} \cdot \frac{dt}{dx} = \frac{1}{x} \frac{dy}{dt}
$$

$$
\frac{d^2 y}{dx^2} = \frac{d}{dx} \left( \frac{1}{x} \frac{dy}{dt} \right) = \frac{1}{x^2} \left( \frac{d^2 y}{dt^2} - \frac{dy}{dt} \right)
$$

$$
\frac{d^3 y}{dx^3} = \frac{1}{x^3} \left( \frac{d^3 y}{dt^3} - 3 \frac{d^2 y}{dt^2} + 2 \frac{dy}{dt} \right), \dots
$$

Substituting into the original equation transforms the Euler equation into a linear differential equation with constant coefficients.<br>
<br>
<strong>[Q]</strong>The general solution of the Euler equation

$
x^2 \frac{d^2 y}{dx^2} + 4x \frac{dy}{dx} + 2y = 0 (x > 0)
$

is $  \boxed{   ?  }$<br>
<strong>[Sol]</strong> Let $x = e^t$, then

$$
\frac{dy}{dx} = \frac{1}{x} \frac{dy}{dt} = e^{-t} \frac{dy}{dt}
\quad \Rightarrow \quad \frac{dy}{dt} = x \frac{dy}{dx},
$$

$$
\frac{d^2y}{dx^2} = \frac{1}{x^2} \left( \frac{d^2y}{dt^2} - \frac{dy}{dt} \right)
= \frac{1}{x^2} \left( x^2 \frac{d^2y}{dx^2} + x \frac{dy}{dx} - x \frac{dy}{dx} \right),
$$

Substitute into the original equation and simplify get

$
\frac{d^2y}{dt^2} + 3\frac{dy}{dt} + 2y = 0
$, solve this equation, the general solution is

$$
y = C_1 e^{-t} + C_2 e^{-2t} = \frac{C_1}{x} + \frac{C_2}{x^2}
$$

\(\therefore\) The answer is

$$
\boxed{y = \frac{C_1}{x} + \frac{C_2}{x^2}}
$$

<h2>Partial Differential Equation</h2>
Let the function $z = f(x, y)$ be defined at and near the point $(a, b)$. Consider the function $z = f(x, b)$.

The derivative at the point $x = a$ is:

$$
\lim_{\Delta x \to 0} \frac{f(a + \Delta x, b) - f(a, b)}{\Delta x}.
$$

If this limit exists, then it is called the partial derivative of the function $z = f(x, y)$ at the point $(a, b)$ with respect to $x$.

It is denoted as:

$$
\frac{\partial f(a, b)}{\partial x}, \quad f_x(a, b), \quad \text{or} \quad \left. \frac{\partial z}{\partial x} \right|_{(a, b)}.
$$

$\frac{\partial f(a, b)}{\partial x}$ reflects how the function $f(x, y)$ changes at point $(a, b)$ along the straight line parallel to the $x$-axis.
What it depicts is the property along that straight line, and in essence it is the derivative of a single-variable function
$
\frac{d}{dx}[f(x, b)]
$. Unlike the derivative notation of a single-variable function $\frac{df(x)}{dx}$, the notation for partial derivatives $\frac{\partial f(a,b)}{\partial x}$ is merely a symbol and should not be interpreted as the quotient of two numbers.
Unlike single-variable functions, whether the partial derivative of a two-variable function exists at a point has no relation to whether the function is continuous at that point (although there is necessarily a connection).<br>

<strong>[Q]</strong> $z = \sin(xy)$<br>
<strong>[Sol]</strong>
$$
\frac{\partial z}{\partial x} = \cos(xy) \cdot y,\quad \frac{\partial z}{\partial y} = \cos(xy) \cdot x
$$

$$
\frac{\partial^2 z}{\partial x^2} = -\sin(xy) \cdot y^2
$$

$$
\frac{\partial^2 z}{\partial y \partial x} = \cos(xy) - xy \cdot \sin(xy)
$$

$$
\frac{\partial^2 z}{\partial x \partial y} = \cos(xy) - xy \cdot \sin(xy)
$$

$$
\frac{\partial^2 z}{\partial y^2} = -x^2 \cdot \sin(xy)
$$

<strong>[Q]</strong> $
u = \ln(x + y + \delta)
$<br>
<strong>[Sol]</strong> $$
\frac{\partial u}{\partial x} = \frac{1}{x + y + \delta}, \quad \frac{\partial u}{\partial y} = \frac{1}{x + y + \delta}
$$

$$
\frac{\partial^2 u}{\partial y \partial x} = -\frac{1}{(x + y + \delta)^2}, \quad \frac{\partial^2 u}{\partial x \partial y} = -\frac{1}{(x + y + \delta)^2}
$$


<img src="Figures/MathsSpeedrun_SketchPDE.png" alt="SketchPDE" style="margin-top: 1.5em; border-radius: 6px; max-width: 100%; display: block;">       


<h2>Cylindrical Coordinates</h2>
Rectangular coordinates $(x, y, z)$ are related to cylindrical coordinates $(r, \theta, z)$ by
$$
\boxed{
\begin{aligned}
x &= r \cos(\theta) \\
y &= r \sin(\theta) \\
z &= z
\end{aligned}
}
$$
<img src="Figures/MathsSpeedrun_CylindricalCoordinates.png" alt="CylindricalCoordinates" style="margin-top: 1.5em; border-radius: 6px; max-width: 100%; display: block;">       
<strong>[Ex]</strong> Consider region $E$ inside cone

$$
z = \sqrt{x^2 + y^2}
$$

with $0 \leq z \leq 1$. Cone in cylindrical coordinates:

$$
z = \sqrt{x^2 + y^2} = \sqrt{r^2 \cos^2(\theta) + r^2 \sin^2(\theta)} = r.
$$

\(\therefore\) We find

$$
E = \{ (r, \theta, z) \mid 0 \leq r \leq z,\ 0 \leq \theta \leq 2\pi,\ 0 \leq z \leq 1 \}
$$
<img src="Figures/MathsSpeedrun_ConeCylindricalCoordinates.png" alt="ConeCylindricalCoordinates" style="margin-top: 1.5em; border-radius: 6px; max-width: 100%; display: block;">       

<strong>[Ex]</strong> The volume element $dV$ in curvilinear coordinates $t^1, t^2, t^3$, as we know, has the form

$$
dV = \sqrt{\det g_{ij}(t)} \, dt^1 \wedge dt^2 \wedge dt^3.
$$

For a triorthogonal system,

$$
dV = \sqrt{E_1 E_2 E_3(t)} \, dt^1 \wedge dt^2 \wedge dt^3.
$$

In particular, in Cartesian, cylindrical, and spherical coordinates, respectively, we obtain

$$
\begin{aligned}
dV &= dx \wedge dy \wedge dz = \\
   &= r \, dr \wedge d\varphi \wedge dz = \\
   &= R^2 \cos \theta \, dR \wedge d\varphi \wedge d\theta.
\end{aligned}
$$

What has just been said enables us to write the form $\omega^3_\rho = \rho \, dV$ in different curvilinear coordinate systems.
Repeated equal signs represent a continuation of equalities across different coordinate systems, and show how the same geometric object (volume form $dV$) takes different analytic forms in different systems.<br>

<strong>[Q]</strong> In cylindrical coordinates $(r, \varphi, z)$ the function $f$ has the form $\ln \frac{1}{r}$. Write the field $\mathbf{A} = \nabla f$ in
<ul>
  <li>Cartesian coordinates</li>
  <li>Cylindrical coordinates</li>
  <li>Spherical coordinates</li>
  <li>Find curl $\mathbf{A}$ and div $\mathbf{A}$</li>
</ul>





<h2>Polar Coordinates</h2>
Our new coordinate system is based on the cylindrical coordinate system. The $z$ axis of the cylindrical system is identical to that of the cartesian system. However, position in the $xy$ plane is described by distance $r$ from the $z$ axis and the angle $\theta$ that $r$ makes with the $x$ axis. These coordinates are shown in the sketch. We see that

$$
r = \sqrt{x^2 + y^2}
$$

$$
\theta = \arctan\left(\frac{y}{x}\right)
$$
<img src="Figures/MathsSpeedrun_PolarCoordinate.png" alt="PolarCoordinate" style="margin-top: 1.5em; border-radius: 6px; max-width: 100%; display: block;">       

Since we shall be concerned primarily with motion in a plane, we neglect the $z$ axis and restrict our discussion to two dimensions. The coordinates $r$ and $\theta$ are called <span class="doubleUnderline">plane polar</span> coordinates. 
The contrast between cartesian and plane polar coordinates is readily seen by comparing drawings of constant coordinate lines for the two systems.
The lines of constant $x$ and of constant $y$ are straight and perpendicular to each other.
Lines of constant $\theta$ are also straight, directed radially outward from the origin.
In contrast, lines of constant $r$ are circles concentric to the origin.<br>
Note: the lines of constant $\theta$ and constant $r$ are perpendicular wherever they intersect.
<img src="Figures/MathsSpeedrun_PlanePolar.png" alt="PlanePolar" style="margin-top: 1.5em; border-radius: 6px; max-width: 100%; display: block;">       
<div class="figure-caption">(Credit: <i>An Introduction to Mechanics</i> by Daniel Kleppner & Robert Kolenkow.)</div>







<h2>Spherical Coordinates</h2>
<img src="Figures/MathsSpeedrun_EarthCoordinates.png" alt="EarthCoordinates" style="margin-top: 1.5em; border-radius: 6px; max-width: 100%; display: block;">       
The usual cartesian coordinate system associated with the Earth is specified as follows:
<ul>
  <li>The origin is the center of the Earth.</li>
  <li>The z-axis is the rotational axis. It pierces the Earth at the poles and its positive direction is towards the north pole. The Earth rotates in the positive direction around this z-axis: when you lay your right hand on the globe such that the thumb shows to the north pole, then the Earth rotates in the direction of the fingers ("the rule of the right hand").</li>
  <li>Great circles passing through the poles are called meridians. The <span class="doubleUnderline">Prime Meridian</span> passes through Royal Observatory in Greenwich (London).</li>
  <li>The plane that is orthogonal to the z-axis is the equatorial plane and the great circle that is located in this plane is the equator.</li>
  <li>The x-axis points towards the intersection of the prime meridian with the equator.</li>
  <li>The y-axis is in the equator plane, it is orthogonal to the x-axis and oriented such that the coordinates build a right-handed system. When the fingers of the right hand go from the x- to the y-axis then the thumb shows in the direction of the z-axis.</li>
</ul>

Each point on the Earth is uniquely defined by its cartesian coordinates (x, y, z). In fact, only 2 coordinates would suffice because each point is on the surface of a sphere:

$$
x^2 + y^2 + z^2 = R^2
$$

where $R$ is the Earth’s radius, $R = 6371.010$ km.

Since this cartesian coordinate system is fixed with the Earth, it is call <span class="doubleUnderline">Earth-centered Earth-fixed</span> system.<br>
Points on the Earth are usually specified in the spherical coordinate system.
The spherical coordinates of an arbitrary cartesian point $P(x, y, z)$ are:
<ul>
<li>The latitude $\varphi$ which is the angle between $OP$ and the equator.</li>
<li>The longitude $\lambda$ which is the angle between the prime meridian and the meridian passing through $OP$.</li>
<li>The radius $r$ which is the distance of $P$ from the origin.</li>
</ul>
Since the radius is constant, the two angles ($\varphi$, $\lambda$) are already sufficient to specify a point on the Earth:

$$
-90^\circ \leq \varphi \leq 90^\circ \quad \text{(Latitude along meridian)}
$$

$$
-180^\circ < \lambda \leq 180^\circ \quad \text{(Longitude along equator)}
$$

The longitude at the poles is arbitrary and is usually set to $0^\circ$ by convention.

We can easily find the relation between the cartesian and spherical coordinates. Let $P(x, y, z)$ be a cartesian point, and $P'$ its projection on the x/y-plane. The length $OP'$ is:

$$
r' = r \cos \varphi
$$

We can now compute the cartesian coordinates from the spherical coordinates:

$$
x = r' \cos \lambda = r \cos \varphi \cos \lambda
$$

$$
y = r' \sin \lambda = r \cos \varphi \sin \lambda
$$

$$
z = r \sin \varphi
$$

Solving these equations for ($\varphi$, $\lambda$, $r$) yields the opposite relationship:

$$
r = \sqrt{x^2 + y^2 + z^2}
$$

$$
\varphi = \arcsin(z / r)
$$

$$
\lambda =  \text{atan2}(y, x)
$$

Note: the simple minded $\lambda = \arctan(y / x)$, which is valid only for $-90^\circ < \lambda < 90^\circ$, was replaced by the correct $\text{atan2}(y, x)$, which yields $-180^\circ < \lambda \leq 180^\circ$. <br>
<img src="Figures/MathsSpeedrun_ENUEarthCoordinates.png" alt="ENUEarthCoordinates" style="margin-top: 1.5em; border-radius: 6px; max-width: 100%; display: block;">       
An East-North-Up (ENU) system uses the Cartesian coordinates (xEast,yNorth,zUp) to represent position relative to a local origin.
The ENU coordinate system is a local system specific to any point $P$ on the Earth. It is formed from a plane tangent to the Earth's surface at the point $P$. In this plane:
<ul>
  <li>The unit vector $\mathbf{E}$ points to the East</li>
  <li>The unit vector $\mathbf{N}$ points to the North</li>
  <li>The unit vector $\mathbf{U}$ points Up, i.e., is orthogonal to the tangent plane.</li>
</ul>

The vector $\mathbf{E} = (E_x, E_y, E_z)$ is tangent to the circle of constant latitude passing through $P$. This circle is also called a "parallel circle" because it is parallel to the equator. The tangent is obtained by taking partial derivatives of the 
$\boxed{
\left\{
\begin{aligned}
x &= r' \cos \lambda = r \cos \varphi \cos \lambda \\
y &= r' \sin \lambda = r \cos \varphi \sin \lambda \\
z &= r \sin \varphi
\end{aligned}
\right.}
$ with respect to $\lambda$ and normalizing the resulting vector to the length 1:

$$
E_x = -\sin \lambda
$$

$$
E_y = \cos \lambda
$$

$$
E_z = 0
$$

The vector $\mathbf{N} = (N_x, N_y, N_z)$ is tangent to the meridian circle passing through $P$. By taking partial derivatives of the $\boxed{
\left\{
\begin{aligned}
x &= r' \cos \lambda = r \cos \varphi \cos \lambda \\
y &= r' \sin \lambda = r \cos \varphi \sin \lambda \\
z &= r \sin \varphi
\end{aligned}
\right.}
$ with respect to $\varphi$ and normalizing the resulting vector to the length 1 we get:

$$
N_x = -\sin(\varphi) \cos(\lambda)
$$

$$
N_y = -\sin(\varphi) \sin(\lambda)
$$

$$
N_z = \cos(\varphi)
$$

The unit vector $\mathbf{U} = (U_x, U_y, U_z)$ points in the direction of $P$. By setting $r = 1$ in the $\boxed{
\left\{
\begin{aligned}
x &= r' \cos \lambda = r \cos \varphi \cos \lambda \\
y &= r' \sin \lambda = r \cos \varphi \sin \lambda \\
z &= r \sin \varphi
\end{aligned}
\right.}
$ we get:

$$
U_x = \cos(\varphi) \cos(\lambda)
$$

$$
U_y = \cos(\varphi) \sin(\lambda)
$$

$$
U_z = \sin(\varphi)
$$

Consider a point $Q$ that has the coordinates $(x, y, z)$ in the Earth-centered Earth-fixed (ECEF) system and coordinates $Q' = (e, n, u)$ in the East-North-Up (ENU) system located at $P = (P_x, P_y, P_z)$. The spherical coordinates of $P$ are $(\varphi, \lambda, R)$. Then the following equation transforms $(e, n, u)$ to $(x, y, z)$:
$$
\begin{bmatrix}
x \\
y \\
z
\end{bmatrix}
=
\begin{bmatrix}
-\sin(\lambda) & \cos(\lambda) & 0 \\
-\sin(\varphi)\cos(\lambda) & -\sin(\varphi)\sin(\lambda) & \cos(\varphi) \\
\cos(\varphi)\cos(\lambda) & \cos(\varphi)\sin(\lambda) & \sin(\varphi)
\end{bmatrix}
\cdot
\begin{bmatrix}
e \\
n \\
u
\end{bmatrix}
+
\begin{bmatrix}
P_x \\
P_y \\
P_z
\end{bmatrix}
$$

Notice that the columns of the transformation matrix $M$ are equal to the vectors $\mathbf{E}, \mathbf{N}, \mathbf{U}$ respectively. Hence, the matrix $M$ is orthonormal. It corresponds to the rotation of the XYZ-system around the origin into the ENU-System (centered at origin). 
The transformation is built by first rotating the vectors $\mathbf{X}, \mathbf{Y}, \mathbf{Z}$ around the origin into $\mathbf{E}, \mathbf{N}, \mathbf{U}$, and then translating this system by the vector $P$ into its final position.

The transformation can be written concisely using vector and matrix notation:

$$
Q = M Q' + P
$$

The transformation from ECEF to ENU is obtained by inverting the transformation $
Q = M Q' + P
$:

$$
Q' = M^\mathrm{-1} (Q - P) = M^\mathrm{T} (Q - P) 
$$

Here we used the fact that the inverse of an orthonormal matrix is equal to its transpose. This equation is in explicit terms as follows:

$$
\begin{bmatrix}
e \\
n \\
u
\end{bmatrix}
=
\begin{bmatrix}
-\sin(\lambda) & \cos(\lambda) & 0 \\
-\sin(\varphi)\cos(\lambda) & -\sin(\varphi)\sin(\lambda) & \cos(\varphi) \\
\cos(\varphi)\cos(\lambda) & \cos(\varphi)\sin(\lambda) & \sin(\varphi)
\end{bmatrix}
\begin{bmatrix}
x - P_x \\
y - P_y \\
z - P_z
\end{bmatrix}
$$

This equation transforms the XYZ-coordinates $(x, y, z)$ of an arbitrary point $Q$ into its ENU-coordinates $(e, n, u)$. The ENU system is located at the point $P$ with XYZ-coordinates $(P_x, P_y, P_z)$ and spherical coordinates $(\varphi, \lambda, R)$.
To solve the asymmetry in the respective transformations, the equation $
Q' = M^\mathrm{-1} (Q - P) = M^\mathrm{T} (Q - P) 
$ can be written as:

$$
Q' = M^\mathrm{-1} Q - M^\mathrm{-1} P 
$$


The meaning is that the ENU system is first rotated around its origin at $P$ by the inverse rotation such that its axes are parallel to the XYZ-system. Afterwards it is translated by the vector $M^\mathrm{T} P$ such that its origin is moved to the origin $O$ of the XYZ-system. 
The expression $M^\mathrm{T} P$ denotes the origin $O = (0, 0, 0)^T$ of the XYZ-system expressed in the ENU-system, as we can see by applying the equation $
Q' = M^\mathrm{-1} Q - M^\mathrm{-1} P 
$ to the point $O$:

  $$
  O' = M^{-1} O - M^{-1} P = -M^{-1} P 
  $$

Finally:

  $$
  Q' = M^{-1} Q + O' 
  $$

which is completely symmetric to the equation $
\boxed{Q = M Q' + P}
$. For computational purposes the explicit form $
  Q' = M^\mathrm{-1} (Q - P) = M^\mathrm{T} Q - M^\mathrm{T} P 
  $ is preferable.

  <br>
<strong>[Ex]</strong> In particular, for Cartesian, cylindrical, and spherical coordinates, we obtain respectively:
$$
\begin{aligned}
\Delta f &= \frac{\partial^2 f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2} + \frac{\partial^2 f}{\partial z^2} = \\
        &= \frac{1}{r} \frac{\partial}{\partial r} \left( r \frac{\partial f}{\partial r} \right) + \frac{1}{r^2} \frac{\partial^2 f}{\partial \varphi^2} + \frac{\partial^2 f}{\partial z^2} = \\
        &= \frac{1}{R^2} \frac{\partial}{\partial R} \left( R^2 \frac{\partial f}{\partial R} \right) + \frac{1}{R^2 \cos^2 \theta} \frac{\partial^2 f}{\partial \varphi^2} + \frac{1}{R^2 \cos \theta} \frac{\partial}{\partial \theta} \left( \cos \theta \frac{\partial f}{\partial \theta} \right)
\end{aligned}
$$

<h2>The Gradient</h2>
Almost any book with mathematical problems and even any textbook of mathematical analysis states something like the following. “Children, remember”:

We call the <span class="doubleUnderline">gradient</span> of a function $U(u, x, z)$ the vector

$$
\text{grad } U := \left( \frac{\partial U}{\partial x}, \frac{\partial U}{\partial y}, \frac{\partial U}{\partial z} \right)
$$

The <span class="doubleUnderline">curl</span> of a vector field $\mathbf{A} = (P, Q, R)(x, y, z)$ is the vector

$$
\text{curl } \mathbf{A} := \left( \frac{\partial R}{\partial y} - \frac{\partial Q}{\partial z}, \frac{\partial P}{\partial z} - \frac{\partial R}{\partial x}, \frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y} \right)
$$

The <span class="doubleUnderline">divergence</span> of a vector field $\mathbf{B} = (P, Q, R)(x, y, z)$ is the function

$$
\text{div } \mathbf{B} := \frac{\partial P}{\partial x} + \frac{\partial Q}{\partial y} + \frac{\partial R}{\partial z}
$$

The fact that this is true only in Cartesian coordinates is not usually discussed, as well as what should be done if the coordinate system is different. This is understandable, since the very formulation of this problem already requires some suitable definition of these objects.



<h2>Divergence and Curl</h2>


<strong>[Q]</strong>The operators grad, curl, and div and the algebraic operations.
Verify the following relations:
<ul>for grad:
<li>(a) $\nabla(f + g) = \nabla f + \nabla g$</li>
<li>(b) $\nabla(f \cdot g) = f \nabla g + g \nabla f$</li>
<li>(c) $\nabla(\mathbf{A} \cdot \mathbf{B}) = (\mathbf{B} \cdot \nabla)\mathbf{A} + (\mathbf{A} \cdot \nabla)\mathbf{B} + \mathbf{B} \times (\nabla \times \mathbf{A}) + \mathbf{A} \times (\nabla \times \mathbf{B})$</li>
<li>(d) $\nabla\left( \frac{1}{2} A^2 \right) = (\mathbf{A} \cdot \nabla)\mathbf{A} + \mathbf{A} \times (\nabla \times \mathbf{A})$</li>
</ul>
<ul>for curl:
<li>(e) $\nabla \times (f \mathbf{A}) = f \nabla \times \mathbf{A} + \nabla f \times \mathbf{A}$</li>
<li>(f) $\nabla \times (\mathbf{A} \times \mathbf{B}) = (\mathbf{B} \cdot \nabla)\mathbf{A} - (\mathbf{A} \cdot \nabla)\mathbf{B} + (\nabla \cdot \mathbf{B})\mathbf{A} - (\nabla \cdot \mathbf{A})\mathbf{B}$</li>
</ul>
<ul>for div:
  <li>(g) $\nabla \cdot (f \mathbf{A}) = \nabla f \cdot \mathbf{A} + f \nabla \cdot \mathbf{A}$</li>
  <li>(h) $\nabla \cdot (\mathbf{A} \times \mathbf{B}) = \mathbf{B} \cdot (\nabla \times \mathbf{A}) - \mathbf{A} \cdot (\nabla \times \mathbf{B})$</li>
</ul>
and rewrite them in the symbols grad, curl, and div.
(Hints: $\mathbf{A} \cdot \nabla = A^1 \frac{\partial}{\partial x^1} + A^2 \frac{\partial}{\partial x^2} + A^3 \frac{\partial}{\partial x^3}$;
$\mathbf{B} \cdot \nabla \neq \nabla \cdot \mathbf{B}$;
$\mathbf{A} \times (\mathbf{B} \times \mathbf{C}) = \mathbf{B}(\mathbf{A} \cdot \mathbf{C}) - \mathbf{C}(\mathbf{A} \cdot \mathbf{B})$.)


<h2>Laplace Operator</h2>

If $\mathbf{a}$ is the gradient of a scalar function $\nabla f$, its divergence is called the <span class="doubleUnderline">Laplacian</span> of $f$.


$$
\nabla^2 f = \nabla \cdot \nabla f = \Delta f
$$

A function that satisfied Laplace’s equation $\nabla^2 f = 0$ is called a <span class="doubleUnderline">potential function</span>.

<ul>
  <li>For a scalar function $f$:
$$
\nabla^2 f = \frac{\partial^2 f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2} + \frac{\partial^2 f}{\partial z^2}
$$

$$
\nabla \cdot \nabla f = \nabla \cdot \left( \frac{\partial f}{\partial x} \mathbf{i} + \frac{\partial f}{\partial y} \mathbf{j} + \frac{\partial f}{\partial z} \mathbf{k} \right)
$$

$$
= \frac{\partial}{\partial x} \left( \frac{\partial f}{\partial x} \right) + \frac{\partial}{\partial y} \left( \frac{\partial f}{\partial y} \right) + \frac{\partial}{\partial z} \left( \frac{\partial f}{\partial z} \right)
$$

$$
= \frac{\partial^2 f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2} + \frac{\partial^2 f}{\partial z^2} = \nabla^2 f
$$
<strong>[Ex]</strong> The Laplacian of the scalar field $f(x, y, z) = xy^2 + z^3$ is

$$
\nabla^2 f(x, y, z) = \frac{\partial^2 f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2} + \frac{\partial^2 f}{\partial z^2}
$$

$$
= \frac{\partial^2}{\partial x^2} (xy^2 + z^3) + \frac{\partial^2}{\partial y^2} (xy^2 + z^3) + \frac{\partial^2}{\partial z^2} (xy^2 + z^3)
$$

$$
= \frac{\partial}{\partial x} (y^2 + 0) + \frac{\partial}{\partial y} (2xy + 0) + \frac{\partial}{\partial z} (0 + 3z^2)
$$

$$
= 0 + 2x + 6z = 2x + 6z
$$</li>
<li>For a vector field $\vec{f}$, apply the Laplace operator to each component of the vector field individually. That is:

$$
\nabla^2 \vec{f} = \left( \nabla^2 f_x, \nabla^2 f_y, \nabla^2 f_z \right)
$$

In addition, there is a commonly used equation:

$$
\nabla^2 \vec{f} = \nabla (\nabla \cdot \vec{f}) - \nabla \times (\nabla \times \vec{f})
$$
<strong>[Ex]</strong> The Laplacian of

$
\mathbf{F}(x, y, z) = 3z^2\mathbf{i} + xyz\mathbf{j} + x^2z^2\mathbf{k}
$

is:

$$
\nabla^2 \mathbf{F}(x, y, z) = \nabla^2 (3z^2)\mathbf{i} + \nabla^2 (xyz)\mathbf{j} + \nabla^2 (x^2z^2)\mathbf{k}
$$

Calculating the components in turn we find:

$$
\nabla^2 (3z^2) = \frac{\partial^2}{\partial x^2}(3z^2) + \frac{\partial^2}{\partial y^2}(3z^2) + \frac{\partial^2}{\partial z^2}(3z^2) = 0 + 0 + 6 = 6
$$

$$
\nabla^2 (xyz) = \frac{\partial^2}{\partial x^2}(xyz) + \frac{\partial^2}{\partial y^2}(xyz) + \frac{\partial^2}{\partial z^2}(xyz) = 0 + 0 + 0 = 0
$$

$$
\nabla^2 (x^2z^2) = \frac{\partial^2}{\partial x^2}(x^2z^2) + \frac{\partial^2}{\partial y^2}(x^2z^2) + \frac{\partial^2}{\partial z^2}(x^2z^2) = 2z^2 + 0 + 2x^2
$$

\(\therefore\) The Laplacian of $\mathbf{F}$ is:

$$
\nabla^2 \mathbf{F} = 6\mathbf{i} + 0\mathbf{j} + (2z^2 + 2x^2)\mathbf{k} = 6\mathbf{i} + 2(x^2 + z^2)\mathbf{k}
$$</li>
</ul>

The Laplacian operator is often written like this: $\nabla^2$. When applied to a scalar function $f$ in space, it's written as $\nabla^2 f$. This is a kind of shorthand notation, which can make it unclear what the physical meaning behind it is. To clarify the meaning of $\nabla^2 f$, let’s rewrite it in its original form: $\nabla \cdot (\nabla f)$.

In Physics: the Laplacian operator is actually an “operation” on the gradient of a scalar field — that is <span class="doubleUnderline">the divergence of the gradient of a scalar field</span>. 
In different coordinate systems (Cartesian, Spherical, Cylindrical, etc.), the form of the Laplacian operator is not the same (the most commonly seen form is in the Cartesian coordinate system:

$$
\frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} + \frac{\partial^2}{\partial z^2}
$$

but the physical meaning is consistent, it represents the divergence of the gradient of a scalar field.<br>

So why is the divergence of the gradient of a scalar field important?  My personal understanding is that

because the divergence of the gradient of a scalar field represents the “driving force” (or potential “trend”) within the field, and this “driving force” can reveal how the system changes from the inside.

The spatial temperature field $T(x, y, z)$ is a scalar field, and its gradient field $\nabla T$ determines the spatial heat flux (heat density flux) vector field $\vec{q}$. At any given point in space, the magnitude of the heat flux is proportional to the magnitude of the gradient (here we assume the material is isotropic).
The heat flux vector points in the opposite direction of the temperature gradient. In mathematical terms, it is written as:

$$
\vec{q} = -k \nabla T
$$

where $k > 0$.

Taking the divergence of the above heat flux field (essentially taking the divergence of the temperature gradient field) gives the heat source/sink at a point in space:
If the divergence is positive, heat flows out — it’s a heat source;
If the divergence is negative, heat flows in — it’s a heat sink.

You may have seen the heat conduction equation:

$$
\frac{\partial^2 T}{\partial x^2} + \frac{\partial^2 T}{\partial y^2} + \frac{\partial^2 T}{\partial z^2} = 0
$$

(this is the standard Laplace equation described in Cartesian coordinates).

Translated into plain language, this equation says: <span class="doubleUnderline">There is no heat source in the space!</span>



<h2>Fourier Series</h2>
<strong>Fourier Series in Trigonometric Form for Periodic Signals:</strong>
Trigonometric function set

$$
\left\{ 1, \cos(n\Omega t), \sin(n\Omega t), \quad n = 1, 2, \ldots \right\}
$$

Let the periodic signal be $f(t)$, with period $T$, and angular frequency

$$
\Omega = \frac{2\pi}{T}
$$

When the Dirichlet conditions are satisfied, the signal can be expanded as a <i>Fourier series in trigonometric form</i>:

$$
f(t) =
\underbrace{\frac{a_0}{2}}_{\substack{\text{Direct Current} \\ \text{(DC component)}}}
 +
\underbrace{\sum_{n=1}^{\infty} a_n \cos(n\Omega t)}_{\text{n-th cosine harmonic}} +
\underbrace{\sum_{n=1}^{\infty} b_n \sin(n\Omega t)}_{\text{n-th sine harmonic}}
$$
The coefficients $a_n$ and $b_n$ are called <i>Fourier coefficients</i>.
<ul>
  <li>DC component:   $
  \frac{a_0}{2} = \frac{1}{T} \int_{-\frac{T}{2}}^{\frac{T}{2}} f(t) \, dt
  $</li>
  <li>Cosine Harmonic Coefficients:  $
  a_n = \frac{2}{T} \int_{-\frac{T}{2}}^{\frac{T}{2}} f(t) \cos(n\Omega t) \, dt
  $</li>
  <li>Sine Harmonic Coefficients:  $
  b_n = \frac{2}{T} \int_{-\frac{T}{2}}^{\frac{T}{2}} f(t) \sin(n\Omega t) \, dt
  $</li>
</ul>

<strong>Dirichlet Conditions:</strong><ul>
  <li>Condition 1: Within one period, the function is either continuous or has only a finite number of first-kind discontinuities (i.e., jump discontinuities).
    <img src="Figures/MathsSpeedrun_DirichletCondition1.png" alt="DirichletCondition1" style="margin-top: 1.5em; max-width: 100%; display: block;">
        <div class="figure-caption">(Counterexample)</div>

  </li>
  <li>Condition 2: Within one period, the function must have only a finite number of maxima and minima
      <img src="Figures/MathsSpeedrun_DirichletCondition2.png" alt="DirichletCondition2" style="margin-top: 1.5em; max-width: 100%; display: block;">
        <div class="figure-caption">(Counterexample)</div></li>
  <li>Condition 3: Within one period, the function must be absolutely integrable.
          <img src="Figures/MathsSpeedrun_DirichletCondition3.png" alt="DirichletCondition3" style="margin-top: 1.5em; max-width: 100%; display: block;">
        <div class="figure-caption">(Counterexample)</div></li>
</ul>

<strong>Cosine Form of Fourier Series</strong>
$$
\boxed{f(t) = \frac{a_0}{2} + \sum_{n=1}^{\infty} \left[ a_n \cos(n\Omega t) + b_n \sin(n\Omega t) \right]}
$$
Combine the $n^\text{th}$ harmonic terms:
$$
\boxed{f(t) = \frac{A_0}{2} + \sum_{n=1}^{\infty} A_n \cos(n\Omega t + \varphi_n)}
$$

$$
\left\{
\begin{aligned}
A_n &= \sqrt{a_n^2 + b_n^2} \\
\varphi_n &= -\arctan\left(\frac{b_n}{a_n}\right)
\end{aligned}
\quad
\begin{aligned}
a_n &= A_n \cos \varphi_n \\
b_n &= -A_n \sin \varphi_n
\end{aligned}
\right.
$$
Meaning:
A periodic signal can be decomposed into a direct current (DC) component and multiple harmonic components.
<ul>
  <li>$\frac{A_0}{2}$: DC component</li>
  <li>$A_1 \cos(\Omega t + \varphi_1)$: Called the <i>fundamental wave</i> or <i>first harmonic</i>, its angular frequency is the same as the original signal.</li>
  <li>$A_2 \cos(2\Omega t + \varphi_2)$: Called the <i>second harmonic</i></li>
  <li>⋯</li>
  <li>$A_n \cos(n\Omega t + \varphi_n)$: Called the <i>n-th harmonic</i></li>
</ul>
<br>
<strong>[Q]</strong> Expand the square wave signal $f(t)$ shown in the figure as a Fourier series.<br>
<img src="Figures/MathsSpeedrun_ExponentialFourier.png" alt="ExponentialFourier" style="margin-top: 1.5em; max-width: 100%; display: block;">

<strong>[Sol]</strong> To calculate the cosine coefficients:
$$
a_n = \frac{2}{T} \int_{-\frac{T}{2}}^{\frac{T}{2}} f(t) \cos(n\Omega t)\,dt
$$

Break the integral over two intervals:

$$
= \frac{2}{T} \int_{-\frac{T}{2}}^{0} (-1) \cdot \cos(n\Omega t)\,dt + \frac{2}{T} \int_{0}^{\frac{T}{2}} 1 \cdot \cos(n\Omega t)\,dt
$$

$$
= \frac{2}{T} \cdot \frac{1}{n\Omega} \left[ -\sin(n\Omega t) \right]_{-\frac{T}{2}}^{0} + \frac{2}{T} \cdot \frac{1}{n\Omega} \left[ \sin(n\Omega t) \right]_{0}^{\frac{T}{2}}
$$

Considering that $\Omega = \frac{2\pi}{T}$, obtain:

$
\boxed{a_n = 0}
$<br>

To compute the sine coefficients:

$$
b_n = \frac{2}{T} \int_{-\frac{T}{2}}^{\frac{T}{2}} f(t) \sin(n\Omega t)\,dt 
= \frac{2}{T} \int_{-\frac{T}{2}}^{0} (-1)\sin(n\Omega t)\,dt 
+ \frac{2}{T} \int_{0}^{\frac{T}{2}} 1 \cdot \sin(n\Omega t)\,dt
$$

$$
= \frac{2}{T} \cdot \frac{1}{n\Omega} \left[ -\cos(n\Omega t) \right]_{-\frac{T}{2}}^{0}
+ \frac{2}{T} \cdot \frac{1}{n\Omega} \left[ -\cos(n\Omega t) \right]_{0}^{\frac{T}{2}}
$$

$$
= \frac{2}{T} \cdot \frac{1}{n\Omega} \left( [1 - \cos(n\Omega T/2)] + [1 - \cos(n\Omega T/2)] \right)
$$

$$
= \frac{2}{T} \cdot \frac{1}{n\Omega} \cdot 2[1 - \cos(n\pi)] = \frac{4}{nT\Omega}[1 - \cos(n\pi)]
$$

Since $\Omega = \frac{2\pi}{T}$, we get:

$$
b_n = \frac{2}{n\pi}[1 - \cos(n\pi)] = 
\begin{cases}
0, & n = 2, 4, 6, \dots \\
\frac{4}{n\pi}, & n = 1, 3, 5, \dots
\end{cases}
$$

The Fourier series expansion of the signal is:

$$
f(t) = \frac{a_0}{2} + \sum_{n=1}^{\infty} a_n \cos(n\Omega t) + \sum_{n=1}^{\infty} b_n \sin(n\Omega t)
$$
$$
= \underbrace{0}_{\text{DC}} 
+ \underbrace{\frac{4}{\pi} \sin(\Omega t)}_{\text{Fundamental}} 
+ \underbrace{\frac{4}{3\pi} \sin(3\Omega t)}_{\text{3rd harmonic}} 
+ \cdots 
+ \underbrace{\frac{4}{n\pi} \sin(n\Omega t)}_{\text{n-th harmonic}}, \quad n = 1, 3, 5, \dots
$$

    <div class="code-block">
        <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

T = 2
A = 1
t = np.linspace(0, 2, 1000)

# Function to compute partial sum
def square_wave_sum(t, max_n):
    result = np.zeros_like(t)
    for n in range(1, max_n+1, 2):
        result += (4*A)/(np.pi*n) * np.sin(2*np.pi*n*t/T)
    return result

# Harmonics for each subplot
harmonic_limits = [1, 3, 5, 7, 99, 999]
titles = [
    "(a) Fundamental (1st harmonic)",
    "(b) 1st & 3rd harmonics",
    "(c) 1st, 3rd & 5th harmonics",
    "(d) 1st, 3rd, 5th & 7th harmonics",
    "(e) 1st, 3rd, ... up to 99th harmonics",
    "(f) 1st, 3rd, ... up to 999th harmonics (Gibbs phenomenon)"
]

fig, axs = plt.subplots(2, 3, figsize=(16, 9), dpi=300)
axs = axs.flatten()

for i, (ax, N, title) in enumerate(zip(axs, harmonic_limits, titles)):
    y = square_wave_sum(t, N)
    ax.plot(t, y, color='#7DCDF4')
    ax.set_title(title, fontsize=12)
    ax.set_xlim(0, 2)
    ax.set_ylim(-1.5, 1.5)
    ax.grid(True)
    ax.set_xlabel('t [s]')
    ax.set_ylabel('Amplitude')

plt.tight_layout()
plt.show()</code></pre>
</div>
<img src="Figures/MathsSpeedrun_HarmonicFourier.png" alt="HarmonicFourier" style="margin-top: 1.5em; border: 1px solid #3c5c78; border-radius: 6px; max-width: 100%; display: block;">        
<br>

<strong>Exponential Form of Fourier Series</strong><br>
The trigonometric form of the Fourier series is conceptually clear but computationally inconvenient, so we often use the exponential form of the Fourier series.

\begin{align*}
f(t) &= \frac{A_0}{2} + \underbrace{\sum_{n=1}^{\infty} A_n \cos(n\Omega t + \varphi_n)}_{\text{Trigonometric form of the Fourier series}} \\
     &= \frac{A_0}{2} + \underbrace{\sum_{n=1}^{\infty} \frac{A_n}{2} \left[ e^{j(n\Omega t + \varphi_n)} + e^{-j(n\Omega t + \varphi_n)} \right]}_{\text{Using Euler's formula}} \\
     &= \frac{A_0}{2} + \frac{1}{2} \sum_{n=1}^{\infty} A_n e^{j\varphi_n} e^{jn\Omega t}
     \boxed{- \underbrace{\frac{1}{2} \sum_{n=1}^{\infty} A_n e^{-j\varphi_n} e^{-jn\Omega t}}_{
     \begin{aligned}
     &\begin{cases}
     -n \rightarrow n \\
     A_{-n} = A_n \\
     \varphi_{-n} = -\varphi_n
     \end{cases}
     \end{aligned}
     }} \\
     &= \frac{A_0}{2} + \frac{1}{2} \sum_{n=1}^{\infty} A_n e^{j\varphi_n} e^{jn\Omega t} 
     \boxed{+ \frac{1}{2} \sum_{n=-1}^{-\infty} A_n e^{j\varphi_n} e^{jn\Omega t}} \\
\end{align*}

Let the complex number

$$
\frac{1}{2} A_n e^{j\varphi_n} = |F_n| e^{j\varphi_n} = F_n
$$

be called the <span class="doubleUnderline">complex Fourier coefficient</span>, or simply the <span class="doubleUnderline">Fourier coefficient</span>.

$$
F_n = \frac{1}{2} A_n e^{j\varphi_n} = \frac{1}{2} (A_n \cos\varphi_n + j A_n \sin\varphi_n) = \frac{1}{2} (a_n - j b_n)
$$

$$
= \frac{1}{T} \int_{-\frac{T}{2}}^{\frac{T}{2}} f(t) \cos(n\Omega t) \, \mathrm{d}t - j \frac{1}{T} \int_{-\frac{T}{2}}^{\frac{T}{2}} f(t) \sin(n\Omega t) \, \mathrm{d}t
$$

<strong>[Q]</strong>Find the exponential form of the Fourier series for the periodic signal shown in the figure.<br>

<strong>[Sol]</strong>Given that $f(t)$ has a period $T = 3$, and $\Omega = \frac{2\pi}{T} = \frac{2\pi}{3}$, it is a periodic signal with period 3. The exponential Fourier coefficient is:
$$
\begin{aligned}
F_n &= \frac{1}{T} \int_0^T f(t)e^{-jn\Omega t} \, dt \\
    &= \frac{1}{3} \left[ \int_0^2 2e^{-jn\Omega t} \, dt - \int_2^3 e^{-jn\Omega t} \, dt \right] \\
    &= \frac{2}{j3n\Omega} \left[1 - e^{-j2n\Omega}\right] + \frac{1}{j3n\Omega} \left[e^{-j3n\Omega} - e^{-j2n\Omega} \right] \\
    &= \frac{2 - 3e^{-j2n\Omega} + e^{-j3n\Omega}}{j3n\Omega} \\
    &= \frac{2 - 3e^{-j\frac{4\pi}{3}n} + e^{-j2\pi n}}{j2\pi n} \\
    &= \frac{3}{j2\pi n} \left(1 - e^{-j\frac{4\pi}{3}n}\right)
\end{aligned}
$$

\(\therefore\) The exponential form of the Fourier series is:
$$
f(t) = \sum_{n=-\infty}^{\infty} F_n e^{jn\Omega t} = \sum_{n=-\infty}^{\infty} \frac{3}{j2\pi n} \left(1 - e^{-j\frac{4\pi}{3}n}\right) e^{jn\Omega t}
$$


<table style="width: 100%; border-collapse: collapse; font-family: 'Courier New', Courier, monospace; background-color: #001a33; color: #aaccee; border: 1px solid #3c5c78;">
  <thead>
    <tr style="border-bottom: 2px solid #3c5c78;">
      <th style="text-align: left; padding: 10px; border-right: 1px solid #3c5c78;">Expression</th>
      <th style="text-align: left; padding: 10px;">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">
        \( f(t) = \sum_{n=-\infty}^{\infty} F_n e^{jn\Omega t} \)
      </td>
      <td style="padding: 8px;">
        Exponential Form Fourier Series
      </td>
    </tr>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">
        \( F_n = \frac{1}{T} \int_{-\frac{T}{2}}^{\frac{T}{2}} f(t) e^{-jn\Omega t} \, dt \)
      </td>
      <td style="padding: 8px;">
        Complex Fourier Coefficient
      </td>
    </tr>
  </tbody>
</table>

Note: Any periodic signal $f(t)$ can be decomposed into a sum of <span class="doubleUnderline">complex exponential signals</span> with different frequencies.
$F_n$ is the coefficient of the component with frequency $n\Omega$, and $F_0 = A_0 / 2$ is the DC component.<br>

<strong>Relationship Between Two Fourier Series Forms</strong>

<table style="width: 100%; border-collapse: collapse; font-family: 'Courier New', Courier, monospace; background-color: #001a33; color: #aaccee; border: 1px solid #3c5c78;">
  <thead>
    <tr style="border-bottom: 2px solid #3c5c78;">
      <th style="text-align: left; padding: 10px; border-right: 1px solid #3c5c78;">Expression</th>
      <th style="text-align: left; padding: 10px;">Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">
        \( f(t) = \frac{a_0}{2} + \sum_{n=1}^{\infty} a_n \cos(n\Omega t) + \sum_{n=1}^{\infty} b_n \sin(n\Omega t) \)
      </td>
      <td style="padding: 8px;">Trigonometric Form Fourier Series</td>
    </tr>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">
        \( = \frac{A_0}{2} + \sum_{n=1}^{\infty} A_n \cos(n\Omega t + \varphi_n) \)
      </td>
      <td style="padding: 8px;"></td>
    </tr>
    <tr style="border-top: 2px solid #3c5c78;">
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">
        \( f(t) = \sum_{n=-\infty}^{\infty} F_n e^{jn\Omega t} \)
      </td>
      <td style="padding: 8px;">Exponential Form Fourier Series</td>
    </tr>
    <tr>
      <td style="padding: 8px; border-right: 1px solid #3c5c78;">
        \( F_n = |F_n| e^{j\varphi_n} = \frac{1}{2} A_n e^{j\varphi_n} = \frac{1}{2}(a_n - jb_n) \)
      </td>
      <td style="padding: 8px;"></td>
    </tr>
  </tbody>
</table>



<h2>The Fourier Transform</h2>

$$
F(j\omega) = \int_{-\infty}^{\infty} f(t) e^{-j\omega t} \, dt
$$

$F(j\omega)$ is called the <strong>Fourier transform</strong> of $f(t)$.

$F(j\omega)$ is generally a <strong>complex function</strong>, expressed as:

$$
F(j\omega) = |F(j\omega)| e^{j\varphi(\omega)}
$$

<ul>
  <li>$|F(j\omega)| \sim \omega$ — this is the amplitude spectrum, and is an even function of frequency $\omega$.</li>
  <li>$\varphi(\omega) \sim \omega$ — this is the phase spectrum, and it is an odd function of frequency $\omega$. </li>
</ul>
<strong>Inverse Fourier Transform:</strong> According to the Fourier series

$
f(t) = \sum_{n=-\infty}^{\infty} F_n e^{j n \Omega t}
= \sum_{n=-\infty}^{\infty} F_n T \cdot e^{j n \Omega t} \cdot \frac{1}{T}
$<br>

When $T \to \infty$:
<ul>
<li>$\Omega \to d\omega$  (differential element)</li>
<li>$n\Omega \to \omega$  (discrete $\to$ continuous)</li>
<li>$\lim_{T \to \infty} F_n T \to F(j\omega)$</li>
<li>$\frac{1}{T} = \frac{\Omega}{2\pi} \to \frac{d\omega}{2\pi}$</li>
<li>$\sum \to \int$</li>
</ul>

Therefore

$$
f(t) = \sum_{n=-\infty}^{\infty} F_n e^{j n \Omega t}
= \sum_{n=-\infty}^{\infty} F_n T \cdot e^{j n \Omega t} \cdot \frac{1}{T} \quad \Rightarrow \boxed{f(t) = \frac{1}{2\pi} \int_{-\infty}^{\infty} F(j\omega) e^{j\omega t} \, d\omega}
$$

<strong>Fourier Transform Pairs:</strong>
$$
F(j\omega) = \int_{-\infty}^{\infty} f(t) e^{-j\omega t} \, dt
\qquad \text{(Fourier Transform uses “−”)}
$$

$$
f(t) = \frac{1}{2\pi} \int_{-\infty}^{\infty} F(j\omega) e^{j\omega t} \, d\omega
\qquad \text{(Inverse Fourier Transform uses "+")}
$$

Simply written as:

$$
F(j\omega) = \mathscr{F}[f(t)]
$$

$$
f(t) = \mathscr{F}^{-1}[F(j\omega)]
$$

Or just:

$$
f(t) \leftrightarrow F(j\omega)
$$

<ul>
  <li>A <string>sufficient condition</string> for the existence of the Fourier transform of a function $f(t)$ is:

$$
\int_{-\infty}^{\infty} |f(t)| \, dt < \infty
$$

<i>(Note: All energy signals satisfy this condition.)</i>

<li>
The following relationships are also useful for conveniently calculating some integrals:

$$
F(0) = \int_{-\infty}^{\infty} f(t) \, dt
$$

$$
f(0) = \frac{1}{2\pi} \int_{-\infty}^{\infty} F(j\omega) \, d\omega
$$</li>
</ul>




<h2>Time-Domain and Frequency-Domain</h2>
<img src="Figures/MathsSpeedrun_TimeDomainFrequencyDomainFourier.png" alt="TimeDomainFrequencyDomainFourier" style="margin-top: 1.5em; max-width: 100%; display: block;">
<div style="font-family: 'Courier New', Courier, monospace; background-color: #001a33; color: #aaccee;">

  <table style="width: 100%; border-collapse: collapse; background-color: #001a33; color: #aaccee; border: 1px solid #3c5c78;">
    <thead>
      <tr style="border-bottom: 2px solid #3c5c78;">
        <th style="padding: 10px; border: 1px solid #3c5c78;">Signal Type</th>
        <th style="padding: 10px; border: 1px solid #3c5c78;">Time Domain \( f(t) \)</th>
        <th style="padding: 10px; border: 1px solid #3c5c78;">Frequency Domain \( F(\omega) \)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="padding: 8px; border: 1px solid #3c5c78;">Unit Impulse</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( \delta(t) \)</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( 1 \)</td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #3c5c78;">Unit Step</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( u(t) \)</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( \pi \delta(\omega) + \frac{1}{j\omega} \)</td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #3c5c78;">Constant Signal</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( 1 \)</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( 2\pi \delta(\omega) \)</td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #3c5c78;">Rectangular Pulse</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( \mathrm{rect}\left(\frac{t}{T}\right) \)</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( T\,\mathrm{sinc}\left(\frac{\omega T}{2}\right) \)</td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #3c5c78;">Triangular Pulse</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( \mathrm{tri}\left(\frac{t}{T}\right) \)</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( \frac{T^2}{2}\,\mathrm{sinc}^2\left(\frac{\omega T}{4}\right) \)</td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #3c5c78;">Sine Wave</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( \sin(\omega_0 t) \)</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( j\pi[\delta(\omega + \omega_0) - \delta(\omega - \omega_0)] \)</td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #3c5c78;">Cosine Wave</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( \cos(\omega_0 t) \)</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( \pi[\delta(\omega + \omega_0) + \delta(\omega - \omega_0)] \)</td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #3c5c78;">Gaussian Signal</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( e^{-t^2/2\sigma^2} \)</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( \sigma \sqrt{2\pi} e^{-\sigma^2\omega^2/2} \)</td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #3c5c78;">One-sided Decaying</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( e^{-a t} u(t) \)</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( \frac{1}{1 + j\omega} \)</td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #3c5c78;">Two-sided Decaying</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( e^{-a|t|} \)</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( \frac{2a}{a^2 + \omega^2} \)</td>
      </tr>
      <tr>
        <td style="padding: 8px; border: 1px solid #3c5c78;">Unit Impulse Train</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( \sum_{n=-\infty}^{\infty} \delta(t - nT) \)</td>
        <td style="padding: 8px; border: 1px solid #3c5c78;">\( \frac{2\pi}{T} \sum_{k=-\infty}^{\infty} \delta\left(\omega - \frac{2\pi k}{T}\right) \)</td>
      </tr>
    </tbody>
  </table>
</div>

<img src="Figures/MathsSpeedrun_FourierTimeAndFrequencyDomains.gif" alt="FourierTimeAndFrequencyDomains" style="margin-top: 1.5em; max-width: 100%; display: block;">
          <div class="figure-caption">(The Fourier transform links a function's time domain (in red) with its frequency domain (in blue). The red waveform is composed of several blue sine waves of different frequencies. The red represents the time domain (showing how the amplitude changes over time), while the resulting blue represents the frequency domain (independent of time, showing the distribution of frequencies).
  Credit: Lucas V. Barbosa)</div> 


<h2>Euler’s Formula and Trigonometry</h2>
Euler’s formula expressing exponential functions in terms of trigonometric functions.<br>
<strong>[Q]</strong> 1. Use Euler's formula to express $e^{-i\theta}$ in terms of sine and cosine.<br>

2. Given that $e^{i\theta} e^{-i\theta} = 1$, what trigonometric identity can be derived by expanding the exponentials in terms of trigonometric functions?<br>

<strong>[Sol]</strong> 1.\(\quad e^{-i\theta} 
= e^{i(-\theta)} 
= \cos(-\theta) + i \sin(-\theta) 
= \underbrace{\cos(\theta)}_{\text{cos is even}} - \underbrace{i \sin(\theta)}_{\text{sin is odd}} \\
\Rightarrow \boxed{e^{-i\theta} = \cos(\theta) - i \sin(\theta)}\)<br>

2. \(\quad e^{i\theta} e^{-i\theta} 
= (\cos\theta + i\sin\theta)(\cos\theta - i\sin\theta) \\
= \cos^2\theta  \cancel{- i\cos\theta\sin\theta} + \cancel{i\cos\theta\sin\theta} - i^2 \sin^2\theta \\
= \cos^2\theta + \sin^2\theta \) 
\((\because i^2 = -1 \text{ and } - i\cos\theta\sin\theta + i\cos\theta\sin\theta = 0) \\
\Rightarrow \boxed{1 = \cos^2\theta + \sin^2\theta}\)



<script>
  function copyToClipboard(btn) {
    const code = btn.nextElementSibling.innerText;
    navigator.clipboard.writeText(code).then(() => {
      btn.classList.add('copied');
      setTimeout(() => btn.classList.remove('copied'), 2000);
    });
  }
</script>


  <p><strong>Next</strong>: <a href="Lecture1.html">Lecture 1 – Introduction and Transport Processes</a></p>

<div class="footer">
  Qi-fan based on the course material by Markus Jochum & Marta Mrozowska <br>
  It is very much a work in progress! Have you spotted a mistake or an error on this page? 
  Click <a href="mailto:qifan.wu@nbi.ku.dk">here</a> to tell me!<br>
  &copy; 2025 TeamOcean | NBI/KU
</div>
</div>

<script>
  function copyToClipboard(btn) {
    const code = btn.nextElementSibling.innerText;
    navigator.clipboard.writeText(code).then(() => {
      btn.classList.add('copied');
      setTimeout(() => btn.classList.remove('copied'), 2000);
    });
  }
</script>
</body>
</html>