<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Project 1 – Oxygen Budget</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      },
      options: {
        renderActions: {
          addMenu: []
        }
      },
      svg: {
        fontCache: 'global',
        scale: 1.0
      }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" async></script>
  
</head>
<body>
  <div class="sidebar">
    <img src="Logo_NS-blackboard-Expand.png" alt="Sidebar Image">
    <nav>
      <ul class="nav-menu">
        <li><a href="Welcome.html">Welcome to NFYK22003U</a></li>
        <li><a href="CourseInformation.html">Course Information</a></li>
        <li><a href="Schedule2025.html">Schedule 2025</a></li>
        <li><a href="MathsSpeedrun.html">Maths Speedrun</a></li>
        <li>
          <a href="Lecture1.html">Lecture 1</a>
          <ul class="sub-menu">
            <li><a href="Project1.html">Project 1 – Oxygen Budget</a></li>
          </ul>
          <li><a href="Lecture2.html">Lecture 2</a></li>
          <ul class="sub-menu">
            <li><a href="Project2.html">Project 2 – The Sverdrup Relation</a></li>
          </ul>
          <li><a href="Lecture3.html">Lecture 3</a></li>
          <li><a href="Lecture4.html">Lecture 4</a></li>
          <ul class="sub-menu">
            <li><a href="Project3.html">Project 3 – Western Boundary Currents</a></li>
          </ul>
          <li><a href="Lecture5.html">Lecture 5</a></li>
          <li><a href="Lecture6.html">Lecture 6</a></li>
          <li><a href="References.html">References</a></li>
        </li>
      </ul>
    </nav>
  </div>

  <div class="main-content">
    <h1>Lecture 4 – The Gulfstream</h1>

    <h2>Western Boundary Currents</h2>
    \(
    u_t + \vec{u} \cdot \nabla u - fv = -\frac{1}{\rho_0}p_x + k \nabla^2 u + F^x
    \)<br>

    \(
    v_t + \vec{u} \cdot \nabla v + fu = -\frac{1}{\rho_0}p_y + k \nabla^2 v + F^y
    \)<br>

    \(
    0 = -\frac{1}{\rho}p_z + g
    \)<br>

    \(
    u_x + v_y + w_z = 0
    \)<br>

Since geostrophy is the dominant balance underneath the mixed layer, it is convenient to define:

\[
u = -\Psi_y, \quad v = \Psi_x, \quad \text{where } \Psi = \frac{p}{\rho_0 f_0}, \quad \text{the streamfunction}
\]

Form the vorticity equation by \((II)_y - (I)_x\) (as before, but now complete, with all the terms):

$$
\zeta_t + \vec{u} \cdot \nabla \zeta + \beta v = (f_0 + \beta y + \zeta) w_z + k_H \nabla^2 \zeta
$$

With $\zeta$ being the <strong>relative vorticity</strong>,

$$
\zeta = v_x - u_y = \nabla^2 \Psi
$$

Exploiting that $f_0 \ll \beta y + \zeta$ (why?) and integrating from top to bottom:

$$
\zeta_t + \vec{u} \cdot \nabla \zeta + \beta v = \frac{f_0}{D}(w_E - w_B) + k_H \nabla^2 \zeta
$$

Three Extra Terms!!

$$
\zeta_t + \vec{u} \cdot \nabla \zeta + \beta v = \frac{f_0}{D}(w_E - w_B) + k_H \nabla^2 \zeta
$$

There is now also an Ekman layer at the bottom of the ocean, but here the friction depends on the flow, i.e., it is part of the solution. At the surface, the stress caused by flow is independent of the flow, since $U_{\text{wind}} \gg U_{\text{ocean}}$.

Let's assume:

$$
\tau^x_{\text{Bottom}} = \alpha u, \quad \tau^y_{\text{Bottom}} = \alpha v
$$

Analogous to the surface Ekman pumping, we then have a bottom Ekman pumping:

$$
w_B = -\frac{\alpha}{\rho_0 f}(v_x - u_y)
$$

So we replace $\frac{f_0}{D} w_B$ with:

$$
r \nabla^2 \psi, \text{ where } r \text{ is a decay rate (think } \zeta_t = -r \nabla^2 \psi \text{)}
$$

<h2>Stream Field</h2>
Stream field in any significant small area can be considered as a set of four basic elementary stream areas: translation, rotation, divergence, and deformation <a href="References.html">[12]</a>.
<ul>
  <li>Streamlines: Line represents the linear curve which is tangential with the local vector current speed.</li>
  <li>Translator field: Because the speed of flow is the vector size, translator field represents movement through the displacement vector field for translation. The fluid moves around the same speed and direction and intensity. Streamlines lie in the direction of flow are the parallel lines. That stream field does not change the volume or shape of the fluid.</li>
  <li>Rotation field: Streamlines are concentric circles. The fluid rotates around a common centre of stream field. The speed of flow increases linearly with increasing distance of streamlines from the centre of rotation. During the rotation, individual air particles do not change its shape or volume.</li>
  <li>Divergence and convergence field: Streamlines are straight and pass through the centre of the field as a joint stream point. 
    When fluid flows towards the centre, flow is convergent, and the point is called convergent point. If the flow is done from the center to the field, it is called the point of divergence. 
    The convergence of a fluid particle does not alter its shape, while both the rate of flow and volume of particle are going to reduce the convergence point. 
    In the divergence, flow is from the centre towards the outer area, the flow increases its velocity and volume, but particles in this case do not change their shape.</li>
  <li>Deformation field: Streamlines are concentric equilateral hyperbolas and their velocity increases linearly in any direction from the center to the field. Linear speed of the centre field linearly increases. 
    Movement does not change the volume of the fluid particle, but it changes its shape. When approaching the common center of the hyperbola (center of the field), the dimensions of the particles decrease in the direction of flow, and when moving away from the center, the dimensions of the particles increase in the direction of flow.</li>
</ul>
<div class="code-block">
  <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
  <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# Set up the common grid
x = np.linspace(-5, 5, 20)
y = np.linspace(-5, 5, 20)
X, Y = np.meshgrid(x, y)

# Define velocity fields
# (a) Translation field: constant velocity
U_a = np.ones_like(X)
V_a = np.zeros_like(Y)

# (b) Rotation field: circular streamlines
U_b = -Y
V_b = X

# (c) Divergence field: radial outward flow
U_c = X
V_c = Y

# (d) Deformation field: saddle/hyperbolic flow
U_d = X
V_d = -Y

vec_color = "#d6ebff"
vec_alpha = 0.8
bg_color = 'none'  # Transparent background

# Create subplots
fig, axs = plt.subplots(2, 2, figsize=(12, 12), tight_layout=True, dpi=300, facecolor=bg_color)

titles = ["(a) Translation", "(b) Rotation", "(c) Divergence", "(d) Deformation"]
fields = [(U_a, V_a), (U_b, V_b), (U_c, V_c), (U_d, V_d)]

for ax, title, (u, v) in zip(axs.flat, titles, fields):
    ax.set_facecolor(bg_color)
    ax.quiver(X, Y, u, v, color=vec_color, alpha=vec_alpha)
    ax.set_title(title, fontsize=16, color=vec_color)
    ax.tick_params(colors=vec_color, labelsize=12)
    ax.spines[:].set_color(vec_color)
    ax.set_aspect('equal')
    ax.grid(True, color=vec_color, alpha=0.3)

plt.show()</code></pre>
</div>
<img src="Figures/Lecture4_StreamField.png" alt="StreamField" style="margin-top: 1.5em; border: 1px solid #3c5c78; border-radius: 6px; max-width: 100%; display: block;">


    
<h2>Vorticity Equation</h2>
  <p>Since the horizontal velocity is divergence-free (because of the flat-bottom and rigid-lid) we may represent it as a streamfunction \(\psi\). Our full vorticity equation rewritten with \(\psi\) is:
      \[
      \overbrace{
        \underbrace{\frac{\partial}{\partial t} (\nabla^2 \psi)}_{\text{Local change of relative vorticity } \zeta = \frac{\partial v}{\partial x} - \frac{\partial u}{\partial y}} + 
        \underbrace{J(\psi, \nabla^2 \psi)}_{\text{Jacobian, Nonlinear advection of vorticity}}
        }^{\text{Material derivative } \frac{D\zeta}{Dt}} + 
        \underbrace{\beta \psi_x}_{\text{Meridional advection of planetary vorticity}} = 
        \underbrace{\frac{f_0}{D} w_E}_{\text{Column Stretching/compression by Ekman pumping}} - 
        \underbrace{r \nabla^2 \psi}_{\text{Linear bottom friction}} + 
        \underbrace{k_H \nabla^4 \psi}_{\text{Horizontal friction}}
      \]
      with
      \[J(A, B) = A_x B_y - A_y B_x\] 

<h2>The Depth Integrated Wind-driven Circulation</h2>
We now have 3 extra physical processes to break the Sverdrup balance, and close the circulation:
<span class= "bullet"></span>bottom friction, <span class= "bullet"></span>sidewall friction, and <span class= "bullet"></span>advection.
Advection may be important locally, but obviously somewhere friction has to remove the vorticity that wind has put into the system. So let’s look for a solution with friction first:<br>
<span class= "bullet"></span>Stommel 1948:

$$
\beta \Psi_x = \frac{f_0}{D} w_E - r \nabla^2 \Psi
$$

<span class= "bullet"></span>Munk 1950:

$$
\beta \Psi_x = \frac{f_0}{D} w_E + k_H \nabla^4 \Psi
$$

<span class= "bullet"></span>Practice with Stommel:

$$
\Psi_{xx} \gg \Psi_{yy} \quad \Longrightarrow \quad \beta \Psi_x = \frac{f_0}{D} w_E - r \Psi_{xx}
$$

We still cannot solve that, but can use perturbation methods, developed in the late fourties ;-)


<h2>Stommel's Solution</h2>
$$
\Psi_{xx} \gg \Psi_{yy} \Longrightarrow \beta \Psi_x = \frac{f_0}{D} w_E - r \Psi_{xx}
$$

Let $\Psi = \Psi^S + \Psi^W$, with $\Psi^S = \frac{f_0}{\beta D} \int_x^{x_E} w_E \, dx$

and $\Psi = 0$ at $x = 0$, $\Psi = \Psi^S$ for large $x$.

$$
\Rightarrow \quad r \Psi^W_{xx} + \beta \Psi^W_x = 0
$$

$$
\Rightarrow \quad \Psi^W = -\Psi^S e^{-x/\delta_S}, \quad \text{and} \quad \Psi = \Psi^S (1 - e^{-x/\delta_S})
$$

with \(\boxed{\delta_S = \beta / r}\), the Stommel boundary layer width

$$
\Rightarrow \quad v = \Psi_x = v_s + \frac{1}{\delta_S} e^{-x/\delta_S}
$$


<h2>Munk's Solution</h2>
$$
\Psi_{xx} \gg \Psi_{yy} \Longrightarrow \beta \Psi_x = \frac{f_0}{D} w_E + k_H \Psi_{xxxx}
$$

Let $\Psi = \Psi^S + \Psi^W$, with

$$
\Psi^S = \frac{f_0}{\beta D} \int_x^{x_E} w_E \, dx
$$

and $\Psi = 0$ at $x = 0$, $\Psi = \Psi^S$ for large $x$.<br>

We need more boundary conditions though!<br>

<span class= "bullet"></span>No slip: $\Psi_x = v = 0$ at $x = 0$<br>

<span class= "bullet"></span>Free slip: $\Psi_{xx} = v_x = 0$ at $x = 0$<br>

The most general solution to Munk’s vorticity equation:

$$
\Psi = \Psi^S \left(1 - e^{\frac{-x}{2 \delta_M}} \cos\left(\sqrt{3}/2 \delta_M x\right)\right) + C(y) \, e^{\frac{-x}{2 \delta_M}} \sin\left(\sqrt{3}/2 \delta_M x\right)
$$

with \(\boxed{\delta_M = \left(\frac{k_H}{\beta}\right)^{1/3}}\), the Munk boundary layer width.

C(y) has to be determined as a function of the boundary conditions:

$$
\Psi = \Psi^S \left(1 - e^{\frac{-x}{2 \delta_M}} \cos\left(\sqrt{3}/2 \delta_M x\right)\right) \pm \frac{1}{\sqrt{3}} \sin\left(\sqrt{3}/2 \delta_M x\right)
$$

















    <p><strong>Next</strong>: <a href="Project3.html">Project 3 – Western Boundary Currents</a></p>
</div>

<div class="footer">
  Qi-fan based on the course material by Markus Jochum & Marta Mrozowska <br>
  It is very much a work in progress! Have you spotted a mistake or an error on this page? 
  Click <a href="mailto:qifan.wu@nbi.ku.dk">here</a> to tell me!<br>
  &copy; 2025 TeamOcean | NBI/KU
</div>

<script>
  function copyToClipboard(btn) {
    const code = btn.nextElementSibling.innerText;
    navigator.clipboard.writeText(code).then(() => {
      btn.classList.add('copied');
      setTimeout(() => btn.classList.remove('copied'), 2000);
    });
  }
</script>
</body>
</html>